/* Simple, clean UI */
:root{
  --bg:#0b0f17;
  --muted:#9fb0c6;
  --text:#e8eef7;
  --line:rgba(255,255,255,.08);
  --primary:#4ea1ff;
  --primary2:#2f7ee6;
  --danger:#ff5a6a;
  --control-h: 42px;
  --focus-border: rgba(78,161,255,.5);
  --focus-shadow: rgba(78,161,255,.12);
  --btn-hover-border: rgba(255,255,255,.18);
  --bg-grad-1: rgba(78,161,255,.12);
  --bg-grad-2: rgba(255,90,106,.10);
  --card-grad-1: rgba(255,255,255,.04);
  --card-grad-2: rgba(255,255,255,.02);
  --field-bg: rgba(0,0,0,.25);
  --btn-bg: rgba(255,255,255,.04);
  --table-head-bg: rgba(12,18,30,.95);
  --tfoot-bg: rgba(255,255,255,.02);
  --item-bg: rgba(0,0,0,.18);
  --preview-bg: rgba(0,0,0,.18);
  --shadow: 0 10px 30px rgba(0,0,0,.28);
  --shadow-strong: 0 18px 55px rgba(0,0,0,.42);
  --table-highlight: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,0) 60%);
  --danger-bg: rgba(255,90,106,.10);
  --danger-border: rgba(255,90,106,.30);
  --danger-text: #ffd5da;
}

html[data-theme="light"]{
  --bg:#f4f8ff;
  --muted:#4b6a94;
  --text:#0b1b33;
  --line:rgba(12,40,80,.16);
  --primary:#2563eb;
  --primary2:#1d4ed8;
  --danger:#dc2626;
  --control-h: 42px;
  --focus-border: rgba(37,99,235,.45);
  --focus-shadow: rgba(37,99,235,.16);
  --btn-hover-border: rgba(12,40,80,.22);
  --bg-grad-1: rgba(37,99,235,.14);
  --bg-grad-2: rgba(14,165,233,.12);
  --card-grad-1: rgba(255,255,255,1);
  --card-grad-2: rgba(244,248,255,1);
  --field-bg: rgba(255,255,255,.92);
  --btn-bg: rgba(37,99,235,.06);
  --table-head-bg: rgba(37,99,235,.08);
  --tfoot-bg: rgba(37,99,235,.04);
  --item-bg: rgba(37,99,235,.04);
  --preview-bg: rgba(37,99,235,.04);
  --shadow: 0 10px 30px rgba(11,27,51,.10);
  --shadow-strong: 0 18px 55px rgba(11,27,51,.18);
  --table-highlight: linear-gradient(180deg, rgba(255,255,255,.85), rgba(255,255,255,0) 55%);
  --danger-bg: rgba(220,38,38,.08);
  --danger-border: rgba(220,38,38,.22);
  --danger-text: #7f1d1d;
}

html{color-scheme: dark}
html[data-theme="light"]{color-scheme: light}

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: radial-gradient(1200px 700px at 20% 0%, var(--bg-grad-1), transparent 60%),
              radial-gradient(900px 600px at 90% 10%, var(--bg-grad-2), transparent 55%),
              var(--bg);
  color:var(--text);
  font-size:clamp(15px, 1.2vw, 16px);
}

.container{max-width:1500px;margin:0 auto;padding:18px}
h1{margin:8px 0 6px;font-size:clamp(22px, 2.4vw, 30px)}
h2{margin:16px 0 10px;font-size:clamp(16px, 1.6vw, 20px)}
p{margin:8px 0}
.muted{color:var(--muted)}
.small{font-size:12px}
.header-title{display:flex;align-items:center;gap:12px}
.header-top{display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap}
.header-logo{height:clamp(70px, 10vw, 100px);width:auto;display:block}
.grid{display:grid;grid-template-columns: 1.3fr .9fr;gap:16px}
@media (max-width: 900px){ .grid{grid-template-columns:1fr} }

@media (max-width: 620px){
  .container{padding:12px}
  .header-title{gap:10px}
  .theme-toggle{width:100%; justify-content:space-between}
  .row .btn{flex:1}
}

.theme-toggle{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding:8px 10px;
  border-radius:999px;
}
.theme-toggle-label{font-size:13px}
.theme-toggle-switch{
  width:42px;
  height:24px;
  border-radius:999px;
  position:relative;
  background: var(--btn-bg);
  border:1px solid var(--line);
  overflow:hidden;
}
.theme-toggle-icons{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:0 6px;
  pointer-events:none;
  z-index:2;
}
.theme-toggle-icon{font-size:12px; line-height:1; opacity:.9; transition: opacity 140ms ease}
html[data-theme="light"] .theme-toggle-icon-sun{opacity:1}
html[data-theme="light"] .theme-toggle-icon-moon{opacity:.55}
html:not([data-theme="light"]) .theme-toggle-icon-sun{opacity:.25}
html:not([data-theme="light"]) .theme-toggle-icon-moon{opacity:1}
.theme-toggle-thumb{
  width:18px;
  height:18px;
  border-radius:999px;
  position:absolute;
  top:50%;
  left:3px;
  transform: translateY(-50%);
  background: linear-gradient(180deg, var(--primary), var(--primary2));
  box-shadow: 0 8px 18px rgba(0,0,0,.18);
  transition: left 140ms ease;
  z-index:1;
}
html[data-theme="light"] .theme-toggle-thumb{box-shadow: 0 8px 18px rgba(11,27,51,.12)}
.theme-toggle:focus-visible{outline:none; box-shadow: 0 0 0 3px var(--focus-shadow); border-color: var(--focus-border)}

html[data-theme="light"] .theme-toggle-switch{background: var(--btn-bg)}

html[data-theme="light"] #themeToggle[aria-checked="true"] .theme-toggle-thumb{left:21px}
html:not([data-theme="light"]) #themeToggle[aria-checked="true"] .theme-toggle-thumb{left:21px}

.card{
  background: linear-gradient(180deg, var(--card-grad-1), var(--card-grad-2));
  border:1px solid var(--line);
  border-radius:14px;
  padding:16px;
  box-shadow: var(--shadow);
}

.form-grid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:10px;
}
@media (max-width: 520px){ .form-grid{grid-template-columns:1fr} }

label{display:flex;flex-direction:column;gap:6px;font-size:14px;color:var(--muted)}
input, select{
  background: var(--field-bg);
  border:1px solid var(--line);
  color:var(--text);
  border-radius:10px;
  padding:10px 10px;
  outline:none;
  min-height: var(--control-h);
  font-size:16px;
}
select{height: var(--control-h)}
input:focus, select:focus{border-color: var(--focus-border); box-shadow: 0 0 0 3px var(--focus-shadow);}

.row{display:flex;gap:10px;align-items:center;margin-top:10px;flex-wrap:wrap}
 label.row{flex-direction:row}

 #renonceIndemnites{
  width:20px;
  height:20px;
  transform: scale(1.15);
  transform-origin: left center;
  accent-color: var(--danger);
 }
 #renonceIndemnites + span{
  color: var(--danger);
  font-weight:700;
 }
.btn{
  border:1px solid var(--line);
  background: var(--btn-bg);
  color:var(--text);
  padding:10px 12px;
  border-radius:12px;
  cursor:pointer;
  font-weight:600;
  font-size:15px;
}
.btn:hover{border-color: var(--btn-hover-border)}
.btn-primary{
  background:
    linear-gradient(180deg, rgba(255,255,255,.18), rgba(255,255,255,0) 55%),
    linear-gradient(180deg, var(--primary), var(--primary2));
  border-color: rgba(255,255,255,.18);
  box-shadow: 0 10px 22px rgba(78,161,255,.18);
}
.btn-ghost{background:transparent}
.btn-danger{
  background: var(--danger-bg);
  border-color: var(--danger-border);
  color: var(--danger-text);
}

.table-wrap{overflow:auto;border:1px solid var(--line);border-radius:12px;box-shadow: var(--shadow-strong);position:relative}
.table-wrap::before{content:"";position:absolute;left:0;right:0;top:0;height:52px;pointer-events:none;border-radius:12px 12px 0 0;background: var(--table-highlight)}
table{width:100%;border-collapse:collapse;min-width:820px}
th,td{border-bottom:1px solid var(--line);padding:10px 10px;font-size:14px}
th{position:sticky;top:0;background: var(--table-head-bg);text-align:left}
td.right{text-align:right}
td.num, th.num{text-align:right; font-variant-numeric: tabular-nums;}
tfoot td{background: var(--tfoot-bg)}
.hint{margin-top:10px;color:var(--muted);font-size:12px}

 .btn-xl{
  padding:14px 16px;
  font-size:16px;
  border-radius:14px;
 }

 .gen-bar{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:14px;
  flex-wrap:wrap;
  margin-top:10px;
 }

 .gen-bar-left{margin:0}

 .gen-bar-right{
  display:flex;
  align-items:center;
  justify-content:flex-end;
  gap:10px;
  flex-wrap:wrap;
 }

 @media (max-width: 620px){
  .gen-bar-right{width:100%}
  .gen-bar-right .btn{flex:1}
 }

.total-mobile{display:none}

@media (max-width: 900px){
  .table-wrap{overflow:visible;border:0;box-shadow:none}
  .table-wrap::before{display:none}
  #fraisTable{min-width:0;width:100%}
  #fraisTable thead,
  #fraisTable tfoot{display:none}
  #fraisTable,
  #fraisTable tbody,
  #fraisTable tr,
  #fraisTable td{display:block}
  #fraisTable tr{
    border:1px solid var(--line);
    border-radius:14px;
    padding:10px;
    background: linear-gradient(180deg, var(--card-grad-1), var(--card-grad-2));
    box-shadow: var(--shadow);
    margin:10px 0;
  }
  #fraisTable td{
    border-bottom:0;
    padding:8px 0;
    text-align:left !important;
  }
  #fraisTable td::before{
    content: attr(data-label);
    display:block;
    font-size:12px;
    color:var(--muted);
    margin-bottom:6px;
  }
  #fraisTable td.cell-actions{padding-top:10px}
  #fraisTable td.cell-actions::before{display:none}
  #fraisTable td.cell-actions .btn{width:100%}

  #fraisTable input,
  #fraisTable select{width:100%; text-align:left !important}

  #fraisTable tr.is-nondep td.cell-km{display:none}

  .total-mobile{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:12px;
    margin-top:10px;
    padding:12px 12px;
    border:1px solid var(--line);
    border-radius:12px;
    background: var(--tfoot-bg);
  }
  .total-mobile strong{font-size:18px; font-variant-numeric: tabular-nums;}
}

 #fraisTable{table-layout:fixed}
 #fraisTable th,
 #fraisTable td{text-align:center; vertical-align:middle}
 #fraisTable td.num,
 #fraisTable th.num{text-align:center}
 #fraisTable th:nth-child(1),
 #fraisTable td:nth-child(1){width:200px}
 #fraisTable th:nth-child(3),
 #fraisTable td:nth-child(3){width:90px}
 #fraisTable th:nth-child(4),
 #fraisTable td:nth-child(4){width:120px}
 #fraisTable th:nth-child(5),
 #fraisTable td:nth-child(5){width:220px}
 #fraisTable th:nth-child(6),
 #fraisTable td:nth-child(6){width:92px}

 #fraisTable th:nth-child(6),
 #fraisTable td:nth-child(6){padding-right:16px}

 #fraisTable input,
 #fraisTable select{width:100%; text-align:center}
 #fraisTable input[type="file"]{width:100%}
 #fraisTable input.km,
 #fraisTable input.amt{padding-left:8px;padding-right:8px}

.list{margin-top:10px;display:flex;flex-direction:column;gap:10px}
.item{
  display:flex;justify-content:space-between;align-items:center;gap:10px;
  border:1px solid var(--line); border-radius:12px;
  padding:10px;background: var(--item-bg)
}
.item .meta{display:flex;flex-direction:column;gap:2px}
.item .meta .name{font-weight:700}
.item .meta .sub{color:var(--muted);font-size:12px}
.item .actions{display:flex;gap:8px;align-items:center}
.badge{font-size:12px;color:var(--muted);border:1px solid var(--line);border-radius:999px;padding:3px 8px}
hr{border:none;border-top:1px solid var(--line);margin:14px 0}

.status{margin-top:10px;min-height:18px;color:var(--muted);font-size:13px}
.footer{padding-top:0;padding-bottom:24px}

 .footer-link{color: var(--text); text-decoration: underline; text-underline-offset: 3px}
 .footer-link:hover{opacity:.9}

 .legal{margin-top:14px}
 .legal h3{margin:14px 0 6px;font-size:14px}

 .preview{margin-top:12px;border:1px solid var(--line);border-radius:12px;overflow:hidden;background: var(--preview-bg)}
 .preview-frame{width:100%;height:620px;border:0;display:block;background:#fff}

 .modal-overlay{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:18px;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(6px);
  z-index: 1000;
 }

 .modal-overlay[hidden]{
  display:none;
 }

 .modal{
  width:min(520px, 100%);
  background: linear-gradient(180deg, var(--card-grad-1), var(--card-grad-2));
  border:1px solid var(--line);
  border-radius:14px;
  box-shadow: var(--shadow-strong);
  padding:18px;
  font-size:14px;
 }

 .modal-header{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  padding-bottom:12px;
  border-bottom:1px solid var(--line);
 }

 .modal-title{
  margin:0;
  font-size:20px;
 }

 .modal-body{margin-top:14px}

 .modal-body label{font-size:14px}
 .modal-body select{font-size:15px}

 .modal-actions{
  display:flex;
  justify-content:flex-end;
  gap:10px;
  margin-top:16px;
 }
